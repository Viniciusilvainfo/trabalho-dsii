<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simple User CRUD – Tailwind</title>
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50 text-gray-800 antialiased">
  <header class="border-b bg-white">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-2xl font-semibold tracking-tight">User Management</h1>
      <div class="flex items-center gap-2">
        <a href="/users/criar"
          class="inline-flex items-center gap-2 rounded-xl bg-gray-100 px-3 py-2 text-sm font-medium hover:bg-gray-200">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-4">
            <path
              d="M12 4.5a.75.75 0 0 1 .75.75v6h6a.75.75 0 0 1 0 1.5h-6v6a.75.75 0 0 1-1.5 0v-6h-6a.75.75 0 0 1 0-1.5h6v-6A.75.75 0 0 1 12 4.5Z" />
          </svg>
          Add User
        </a>
        <a href="/users/exportar"
          class="inline-flex items-center gap-2 rounded-xl bg-black text-white px-3 py-2 text-sm font-medium hover:bg-gray-800">
          Export
        </a>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <!-- Filters / Toolbar (static) -->
    <form class="mb-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3" method="get" action="/users/lista">
      <div class="relative">
        <input type="text" name="name" value="<%= name %>" placeholder="Search users..."
          class="w-full rounded-2xl border border-gray-300 bg-white px-4 py-2.5 text-sm focus:outline-none focus:ring-4 focus:ring-gray-200" />
        <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-4 text-gray-500">
            <path fill-rule="evenodd"
              d="M10.5 3.75a6.75 6.75 0 1 1 0 13.5 6.75 6.75 0 0 1 0-13.5Zm0 1.5a5.25 5.25 0 1 0 0 10.5 5.25 5.25 0 0 0 0-10.5Zm8.03 13.28a.75.75 0 1 1-1.06 1.06l-3.25-3.25a.75.75 0 0 1 1.06-1.06l3.25 3.25Z"
              clip-rule="evenodd" />
          </svg>
        </div>
      </div>
      <select name="role"
        class="rounded-2xl border border-gray-300 bg-white px-3 py-2.5 text-sm focus:outline-none focus:ring-4 focus:ring-gray-200">
        <option value="">All Roles</option>
        <option value="ADMIN" <% if(role=="ADMIN" ) { %> selected <% } %> >Admin</option>
        <option value="MANAGER" <% if(role=="MANAGER" ) { %> selected <% } %> >Manager</option>
        <option value="EDITOR" <% if(role=="EDITOR" ) { %> selected <% } %> >Editor</option>
        <option value="VIEWER" <% if(role=="VIEWER" ) { %> selected <% } %> >Viewer</option>
      </select>
      <select name="status"
        class="rounded-2xl border border-gray-300 bg-white px-3 py-2.5 text-sm focus:outline-none focus:ring-4 focus:ring-gray-200">
        <option value="">Any Status</option>
        <option value="ACTIVE" <% if(status=="ACTIVE" ) { %> selected <% } %> >Active</option>
        <option value="INVITED" <% if(status=="INVITED" ) { %> selected <% } %> >Invited</option>
        <option value="SUSÉNDED" <% if(status=="SUSÉNDED" ) { %> selected <% } %> >Suspended</option>
        <option value="DELETED" <% if(status=="DELETED" ) { %> selected <% } %> >Deleted</option>
      </select>
      <select name="sort"
        class="rounded-2xl border border-gray-300 bg-white px-3 py-2.5 text-sm focus:outline-none focus:ring-4 focus:ring-gray-200">
        <option value="">Sort: Newest First</option>
        <option value="O" <% if(sort=="O" ) { %> selected <% } %> >Sort: Oldest First</option>
        <option value="A" <% if(sort=="A" ) { %> selected <% } %> >Sort: Name A → Z</option>
        <option value="Z" <% if(sort=="Z" ) { %> selected <% } %> >Sort: Name Z → A</option>
      </select>
      <button
        class="inline-flex items-center gap-2 rounded-xl bg-black text-white px-3 py-2 text-sm font-medium hover:bg-gray-800">
        Filtrar
      </button>
    </form>

    <!-- Users Table -->
    <section class="bg-white border rounded-2xl shadow-sm">
      <div class="overflow-x-auto rounded-2xl">
        <table class="min-w-full text-left align-middle">
          <thead class="bg-gray-50 text-xs uppercase tracking-wider text-gray-500">
            <tr>
              <th class="px-4 py-3">User</th>
              <th class="px-4 py-3">Email</th>
              <th class="px-4 py-3">Role</th>
              <th class="px-4 py-3">Status</th>
              <th class="px-4 py-3">Created</th>
              <th class="px-4 py-3 text-right">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100">

            <% dados.forEach(user=> { %>

              <tr class="hover:bg-gray-50">
                <td class="px-4 py-3">
                  <div class="flex items-center gap-3">
                    <span
                      class="inline-flex size-9 items-center justify-center rounded-full bg-indigo-100 text-indigo-700 text-sm font-semibold">VM</span>
                    <div>
                      <div class="font-medium">
                        <%= user.name %>
                      </div>
                      <div class="text-xs text-gray-500">
                        <%= user.username %>
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-4 py-3">
                  <%= user.email %>
                </td>
                <td class="px-4 py-3">
                  <span class="inline-flex items-center rounded-full bg-gray-100 px-2.5 py-1 text-xs font-medium">
                    <%= user.role %>
                  </span>
                </td>
                <td class="px-4 py-3">
                  <span class="inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-medium
                    <% if (user.status == 'ACTIVE') { %>
                      bg-green-100
                    <% } else if (user.status == 'INACTIVE') { %>
                      bg-gray-100
                    <% } else { %>
                      bg-orange-100
                    <% } %>
                    ">
                    <%= user.status %>
                  </span>
                </td>
                <td class="px-4 py-3 text-sm text-gray-600">
                  <%= user.createdAt %>
                </td>
                <td class="px-4 py-3">
                  <div class="flex items-center justify-end gap-2">
                    <a href="/users/<%= user.id %>/edit"
                      class="rounded-xl border px-3 py-1.5 text-sm hover:bg-gray-50">Edit</a>

                    <% if(user.role !='ADMIN' ) { %>
                      <a href="/users/<%= user.id %>/delete"
                        class="rounded-xl bg-red-50 px-3 py-1.5 text-sm text-red-700 hover:bg-red-100">Delete</a>
                      <% } %>
                  </div>
                </td>
              </tr>
              <% }) %>
          </tbody>
        </table>
      </div>

      <div class="flex items-center justify-between px-4 py-3 border-t bg-gray-50">
        <p class="text-sm text-gray-600">
          Showing
          <span class="font-medium">
            <% const start=(currentPage - 1) * limit + 1; %>
              <% const end=Math.min(currentPage * limit, total); %>
                <%= start %>–<%= end %>
          </span>
          of <span class="font-medium">
            <%= total %>
          </span> users
        </p>

        <nav class="inline-flex items-center gap-1">
          <% if (currentPage> 1) { %>
            <a href="?page=<%= currentPage - 1 %>&limit=<%= limit %><% if (name) { %>&name=<%= name %><% } %><% if (role) { %>&role=<%= role %><% } %><% if (status) { %>&status=<%= status %><% } %><% if (sort) { %>&sort=<%= sort %><% } %>"
              class="rounded-xl border px-3 py-1.5 text-sm hover:bg-gray-100">
              Previous
            </a>
            <% } else { %>
              <span class="rounded-xl border px-3 py-1.5 text-sm text-gray-400 cursor-not-allowed">Previous</span>
              <% } %>

                <% for (let i=1; i <=totalPages; i++) { %>
                  <% if (i===currentPage) { %>
                    <span class="rounded-xl bg-black text-white px-3 py-1.5 text-sm">
                      <%= i %>
                    </span>
                    <% } else { %>
                      <a href="?page=<%= i %>&limit=<%= limit %><% if (name) { %>&name=<%= name %><% } %><% if (role) { %>&role=<%= role %><% } %><% if (status) { %>&status=<%= status %><% } %><% if (sort) { %>&sort=<%= sort %><% } %>"
                        class="rounded-xl border px-3 py-1.5 text-sm hover:bg-gray-100">
                        <%= i %>
                      </a>
                      <% } %>
                        <% } %>

                          <% if (currentPage < totalPages) { %>
                            <a href="?page=<%= currentPage + 1 %>&limit=<%= limit %><% if (name) { %>&name=<%= name %><% } %><% if (role) { %>&role=<%= role %><% } %><% if (status) { %>&status=<%= status %><% } %><% if (sort) { %>&sort=<%= sort %><% } %>"
                              class="rounded-xl border px-3 py-1.5 text-sm hover:bg-gray-100">
                              Next
                            </a>
                            <% } else { %>
                              <span
                                class="rounded-xl border px-3 py-1.5 text-sm text-gray-400 cursor-not-allowed">Next</span>
                              <% } %>
        </nav>
      </div>
    </section>
  </main>

  <footer class="max-w-6xl mx-auto px-4 py-10 text-center text-xs text-gray-500">
    Built with Tailwind CSS – no JavaScript included.
  </footer>
</body>

</html>